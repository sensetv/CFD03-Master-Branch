################################################################################
#
#   SECTION: Capabilities
#
#   - This section defines the capabilities of fabric network. This is a new
#   concept as of v1.1.0 and should not be utilized in mixed networks with
#   v1.0.x peers and orderers.  Capabilities define features which must be
#   present in a fabric binary for that binary to safely participate in the
#   fabric network.  For instance, if a new MSP type is added, newer binaries
#   might recognize and validate the signatures from this type, while older
#   binaries without this support would be unable to validate those
#   transactions.  This could lead to different versions of the fabric binaries
#   having different world states.  Instead, defining a capability for a channel
#   informs those binaries without this capability that they must cease
#   processing transactions until they have been upgraded.  For v1.0.x if any
#   capabilities are defined (including a map with all capabilities turned off)
#   then the v1.0.x peer will deliberately crash.
#
################################################################################
Capabilities:
    
    Channel: &ChannelCapabilities
        V1_3: true
    Orderer: &OrdererCapabilities
        V1_1: true
    Application: &ApplicationCapabilities
        V1_3: true
        V1_2: false
        V1_1: false

################################################################################
#
#   SECTION: Application
#
#   - This section defines the values to encode into a config transaction or
#   genesis block for application related parameters
#
################################################################################

Application: &ApplicationDefaults
  Organizations:
   # Policies defines the set of policies at this level of the config tree
    # For Application policies, their canonical path is
    #   /Channel/Application/<PolicyName>
  Policies:
      Readers:
        Type: ImplicitMeta
        Rule: "ANY Readers"
      Writers:
        Type: ImplicitMeta
        Rule: "ANY Writers"
      Admins:
        Type: ImplicitMeta
        Rule: "MAJORITY Admins"

################################################################################
#
#   Section: Organizations
#
#   - This section defines the different organizational identities which will
#   be referenced later in the configuration.
#
################################################################################

Organizations:
  - &OrdererOrg
      Name: OrdererOrg
      ID: OrdererMSP
      MSPDir: crypto-config/ordererOrganizations/smartsign.app/msp
      # Policies defines the set of policies at this level of the config tree
      # For organization policies, their canonical path is usually
      #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>
      Policies:
          Readers:
              Type: Signature
              Rule: "OR('OrdererMSP.member')"
          Writers:
              Type: Signature
              Rule: "OR('OrdererMSP.member')"
          Admins:
              Type: Signature
              Rule: "OR('OrdererMSP.admin')"
  - &STJOrg
      Name: STJOrgMSP
      ID: STJOrgMSP
      MSPDir: crypto-config/peerOrganizations/stj.smartsign.app/msp
      Policies:
        Readers:
             Type: Signature
             Rule: "OR('STJOrgMSP.admin', 'STJOrgMSP.peer', 'STJOrgMSP.client')"
        Writers:
             Type: Signature
             Rule: "OR('STJOrgMSP.admin', 'STJOrgMSP.client')"
        Admins:
            Type: Signature
            Rule: "OR('STJOrgMSP.admin')"
      AnchorPeers:
        - Host: peer0.stj.smartsign.app
          Port: 7051
  - &TJSEOrg
      Name: TJSEOrgMSP
      ID: TJSEOrgMSP
      MSPDir: crypto-config/peerOrganizations/tj-se.smartsign.app/msp
      Policies:
        Readers:
             Type: Signature
             Rule: "OR('TJSEOrgMSP.admin', 'TJSEOrgMSP.peer', 'TJSEOrgMSP.client')"
        Writers:
             Type: Signature
             Rule: "OR('TJSEOrgMSP.admin', 'TJSEOrgMSP.client')"
        Admins:
            Type: Signature
            Rule: "OR('TJSEOrgMSP.admin')"
      AnchorPeers:
        - Host: peer0.tj-se.smartsign.app
          Port: 7051
  - &TJSPOrg
      Name: TJSPOrgMSP
      ID: TJSPOrgMSP
      MSPDir: crypto-config/peerOrganizations/tj-sp.smartsign.app/msp
      Policies:
        Readers:
             Type: Signature
             Rule: "OR('TJSPOrgMSP.admin', 'TJSPOrgMSP.peer', 'TJSPOrgMSP.client')"
        Writers:
             Type: Signature
             Rule: "OR('TJSPOrgMSP.admin', 'TJSPOrgMSP.client')"
        Admins:
            Type: Signature
            Rule: "OR('TJSPOrgMSP.admin')"
      AnchorPeers:
        - Host: peer0.tj-sp.smartsign.app
          Port: 7051
  - &TJBAOrg
      Name: TJBAOrgMSP
      ID: TJBAOrgMSP
      MSPDir: crypto-config/peerOrganizations/tj-ba.smartsign.app/msp
      Policies:
        Readers:
             Type: Signature
             Rule: "OR('TJBAOrgMSP.admin', 'TJBAOrgMSP.peer', 'TJBAOrgMSP.client')"
        Writers:
             Type: Signature
             Rule: "OR('TJBAOrgMSP.admin', 'TJBAOrgMSP.client')"
        Admins:
            Type: Signature
            Rule: "OR('TJBAOrgMSP.admin')"
      AnchorPeers:
        - Host: peer0.tj-ba.smartsign.app
          Port: 7051

################################################################################
#
#   SECTION: Orderer
#
#   - This section defines the values to encode into a config transaction or
#   genesis block for orderer related parameters
#
################################################################################

Orderer: &OrdererDefaults
  OrdererType: solo
  Addresses:
  - orderer.smartsign.app:7050
  BatchTimeout: 2s
  BatchSize:
    MaxMessageCount: 10
    AbsoluteMaxBytes: 99 MB
    PreferredMaxBytes: 512 KB
  Kafka:
    # Brokers: A list of Kafka brokers to which the orderer connects
    # NOTE: Use IP:port notation
    Brokers:
     - 127.0.0.1:9092
  Organizations:
    # Policies defines the set of policies at this level of the config tree
    # For Orderer policies, their canonical path is
    #   /Channel/Orderer/<PolicyName>
  Policies:
      Readers:
          Type: ImplicitMeta
          Rule: "ANY Readers"
      Writers:
          Type: ImplicitMeta
          Rule: "ANY Writers"
      Admins:
          Type: ImplicitMeta
          Rule: "MAJORITY Admins"
      # BlockValidation specifies what signatures must be included in the block
      # from the orderer for the peer to validate it.
      BlockValidation:
          Type: ImplicitMeta
          Rule: "ANY Writers"

################################################################################
#
#   CHANNEL
#
#   This section defines the values to encode into a config transaction or
#   genesis block for channel related parameters.
#
################################################################################
Channel: &ChannelDefaults
    # Policies defines the set of policies at this level of the config tree
    # For Channel policies, their canonical path is
    #   /Channel/<PolicyName>
    Policies:
        # Who may invoke the 'Deliver' API
        Readers:
            Type: ImplicitMeta
            Rule: "ANY Readers"
        # Who may invoke the 'Broadcast' API
        Writers:
            Type: ImplicitMeta
            Rule: "ANY Writers"
        # By default, who may modify elements at this config level
        Admins:
            Type: ImplicitMeta
            Rule: "MAJORITY Admins"

    # Capabilities describes the channel level capabilities, see the
    # dedicated Capabilities section elsewhere in this file for a full
    # description
    Capabilities:
        <<: *ChannelCapabilities

################################################################################
#
#   Profile
#
#   - Different configuration profiles may be encoded here to be specified
#   as parameters to the configtxgen tool
#
################################################################################

Profiles:
  OrdererGenesis:
    <<: *ChannelDefaults
    Orderer:
      <<: *OrdererDefaults
      Organizations:
        - *OrdererOrg
      Capabilities:
        <<: *OrdererCapabilities
    Consortiums:
      TJConsortium:
        Organizations:
          - *STJOrg
          - *TJSEOrg
          - *TJSPOrg
          - *TJBAOrg

  STJChannel:
    Consortium: TJConsortium
    Application:
      <<: *ApplicationDefaults
      Organizations:
        - *STJOrg
        - *TJSEOrg
        - *TJSPOrg
        - *TJBAOrg
      Capabilities:
        <<: *OrdererCapabilities

  TJSEChannel:
    Consortium: TJConsortium
    Application:
      <<: *ApplicationDefaults
      Organizations:
        - *STJOrg
        - *TJSEOrg
      Capabilities:
        <<: *OrdererCapabilities

  TJBAChannel:
    Consortium: TJConsortium
    Application:
      <<: *ApplicationDefaults
      Organizations:
        - *STJOrg
        - *TJBAOrg
      Capabilities:
        <<: *OrdererCapabilities

  TJSPChannel:
    Consortium: TJConsortium
    Application:
      <<: *ApplicationDefaults
      Organizations:
        - *STJOrg
        - *TJSPOrg
      Capabilities:
        <<: *OrdererCapabilities


